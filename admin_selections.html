<!DOCTYPE html>
<html>
<head>
    <title>Manifest Selection</title>
    <meta charset = "UTF-8">
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="boatRes.css">
    <script>

        $(function () {
     
                //init datepickers once boats added
                var boatDates = [];     //will hold json data
                $.getJSON("getManifestBoats.php", function(jsonDates){
                    for(i=0; i < jsonDates.length; i++){
                        boatDates.push(jsonDates[i]);
                    }
                 
                    $("#manifestDate").datepicker({
                        minDate: '+1',
                        maxDate: '+30',
                        beforeShowDay: function(testDate){
                            var d = testDate.getDate();
                            var m = testDate.getMonth();
                            m += 1; //since months are 0-11
                            var y = testDate.getFullYear();
                            //format date yyyy-mm-dd
                            var formatDate = y + '-' +
                                (m<10 ? '0' : '') + m + '-' +
                                (d<10 ? '0' : '') + d;
                            if ($.inArray(formatDate, boatDates) > -1){
                                return [true];
                            }
                            else {
                                return [false];
                            }
                        }
                    });
                   
            });
            
            //ensure guest and radios unchecked on back to page     
            $('#manifest').prop('checked', false);

            //show hide date fields      
            $('input[type=radio][name=manifestType]').on('change', function (){
                //always hide possible error after change
                $('#selectTypeReq').hide();
                $('#manifestDateReq').hide();

                //reset values                       
                $('#manifestDate').val('');
                switch ($(this).val()) {          
                           
                    case 'manifest':
                        $('#manifestDiv').show();                    
                        break;               
                }   
            });

            //remove error msgs on changing values          q
            $('#manifestDate').on('change', function(){
                $('#manifestDateReq').hide();           
            });
             
              
        });
        function whenSubmit(){
            //remove any submit msg
            $('#subMsg').html(""); 
                          

            //trip type
            if (!$('[name="manifestType"]').is(':checked')){
                //show error
                $('#selectTypeReq').show();
            //    $('#roundtrip').focus()
                return false;
            }
            else{
                $('#selectTypeReq').hide();
            }

         
             if ($('[name="manifestType"]:checked').val() === 'manifest'){
                 //hide errors to start           
                $('#manifestDateReq').hide();

                //check date and time            
                if(!$('#manifestDate').val()){
                    $('#manifestDateReq').show();
                    return false;
                }
             
            }


            //submit if passes all       
            var formData = $('#adminForm').serialize();
            //return true to complete submit
            return true;
        }
 
        
    </script>
</head>
<body>
    <div id="outerDiv">
        <form id="adminForm" action="manifest.php" method="post"
            onsubmit="return whenSubmit()" novalidate>
        <legend><b>Manifest View/Print</b></legend>
                 

        <p>Please select manifest type:</p>
      
        <p><input type="radio" name="manifestType" id="manifest"
                  value="manifest">
                  View Manifest
        </p>
           
        <div id="selectTypeReq">Select a trip type.</div>
        <div id="manifestDiv">
            <p>
                <label for="manifestDate">Select Manifest Date:
                </label>
            </p>
            <p><input id="manifestDate" name="manifestDate" type="text"></p>
            <div id="manifestDateReq">Select a manifest date.</div>
        </div>
  
               <script>
                    $('#manifestDate').on('change', function(){
                        var dd = new Date($('#manifestDate').val());
                        var d = dd.getDate();
                        var m = dd.getMonth();
                        m += 1; //since months are 0-11
                        var y = dd.getFullYear();
                        var formatDate = y + '-' +
                            (m<10 ? '0' : '') + m + '-' +
                            (d<10 ? '0' : '') + d; //format date yyyy-mm-dd
                        $('#manifestDate').val(formatDate);
                        var sendDate = $('#adminForm').serialize();  
  
    
                    });
                </script>

     
    
        
        <div id="submitDiv">
            <input id="submitButton" type="submit" value="Submit">
            <span id="subMsg"></span>
        </div>
        </form>
    </div>
</body>
</html>